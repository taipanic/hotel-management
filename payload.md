# Payload

## Note

Some syntax may not be supported by BitBucket properly.  
See [this file on GitHub](https://github.com/taipanic/iot-app/blob/main/README.md) instead.

## Provisioning

### Provisioning message properties

- **`k`**: `string` `mandatory` `unique`
  - apikey. Every gateway is assigned to an arbitrary, unique apikey when first created.
- **`d`**: `array` `mandatory`
  - data. Data is an array of channel objects. Each channel object contains provisioning data about a particular/specific channel.

### Channel object properties

- **`localId`**: `string` `mandatory` `unique`
  - Generated by gateway that is assigned to a particular channel. Must be unique in gateway scope.
- **`value`**: `string` `mandatory`
  - Type of value of record that will be sent upstream. Must be consistent among channel life.
  - Possible value: `"String"`, `"Number"`, `"Boolean"`. Default to `"String"`.
- **`scale`**: `number` `optional`
  - Scale of the value of records. Should only be provided when **`value`** is `"Number"`.
  - Possible value: ..., `-3`, `-2`, `-1`, `0`, `1`, `2`, `3`, ... . Default to `0`.
- **`timeseries`**: `boolean` `optional`
  - If `true`, records that are sent from this channel are timeseries data.
  - Possible value: `true`, `false`. Default to `false`.
- **`command`**: `boolean` `optional`
  - If `true`, the channel has ability to received command.
  - Possible value: `true`, `false`. Default to `false`.
- **`name`**: `string` `optional`
  - Name of the channel. If not provided, **`name`** will be the same as **`localId`**.

### Example provisioning message

```json
{
  "k": "abcdef",
  "d": [
    {
      "localId": "uid001",
      "value": "Number",
      "scale": 0,
      "timeseries": true,
      "command": true,
      "name": "channel001"
    },
    {
      "localId": "uid002",
      "value": "String",
      "timeseries": false,
      "command": true,
      "name": "channel2"
    },
    {
      "localId": "uid003",
      "value": "Boolean",
      "timeseries": false,
      "command": true,
      "name": "channel3"
    }
  ]
}
```

## Telemetry

### Telemetry message properties

- **`k`**: `string` `mandatory` `unique`
  - Is `apikey` of provisioned gateway.
- **`d`**: `array` `mandatory`
  - Is `data`, an array of channel objects. Each channel object contains telemetry data about a particular/specific channel.

### Channel object properties

- **`i`**: `string` `mandatory` `unique`
  - `localId` of provisioned channel.
- **`r`**: `array` `optional`
  - `records` of timeseries measurement. Is an array contain one or multiple objects, each of which is a record which has `t` as `time`, `v` as measured `value`.
- **`v`**: `string` | `number` | `boolean` `optional`
  - `value` of non-timeseries channel.

### Example telemetry message

```json
{
  "k": "abcdef",
  "d": [
    {
      "i": "uid001",
      "r": [
        { "t": "1002", "v": 11 },
        { "t": "1005", "v": 13 }
      ]
    },
    {
      "i": "uid002",
      "v": "Off"
    },
    {
      "i": "uid003",
      "v": true
    }
  ]
}
```

## Command

### Command message properties

- **`k`**: `string` `mandatory` `unique`
  - Is `apikey` of provisioned gateway.
- **`d`**: `array` `mandatory`
  - Is `data`, an array of channel objects. Each channel object contains command data about a particular/specific channel.

### Channel object properties

- **`i`**: `string` `mandatory` `unique`
  - Is `localId` of provisioned channel.
- **`c`**: `string` `mandatory`
  - Is `command` string that has been previously defined/
- **`v`**: `string` | `number` | `boolean` `optional`
  - Is `value` of command argument. Is optional if the command doesn't required it (e.g. `"toggle"` command).

### Example command message

```json
{
  "k": "abcdef",
  "d": [
    {
      "i": "uid001",
      "c": "set",
      "v": 12
    },
    {
      "i": "uid002",
      "c": "set",
      "v": "On"
    }
    {
      "i": "uid003",
      "c": "set",
      "v": false
    }
  ]
}
```
